# PKgame Spring Boot 実装の進める順番

1. 文字コード確認と仕様確定
- コンソール版 Main.java を UTF-8 で読める状態にし、main_spec.txt と差分がないか確認する。
- 仕様の確定版を main_spec.txt に反映する（差分があれば追記）。

2. プロジェクト骨組みの整備
- Spring Boot のパッケージ構成を決める（例: controller / service / domain / web / viewmodel）。
- ルーティングとテンプレートの最小構成を作る（GET / で index.html を返す）。

3. ゲームロジックの移植
- Main.java の純ロジック部分（キー配置、判定、AI、スコア、サドンデス）を Java クラスとして分離。
- 入力/出力依存を除いた「ゲームエンジン」クラスを作る。

4. 画面モデルの設計
- 画面で必要な状態（スコア、ラウンド、履歴、直近結果など）を DTO/VM として定義。
- 1ターン進行 API の入出力仕様を決める（例: POST /play）。

5. 画面（Thymeleaf + JS/CSS）作成
- index.html にゴール描画、ボタン配置、結果表示欄を作成。
- app.css でレイアウトと見た目を調整。
- app.js でクリック入力・API 呼び出し・描画更新を実装。

6. 連携と動作確認
- Controller とゲームロジックを接続。
- プレイヤー/AI の交互処理、早期決着、サドンデスが正しく動くか確認。

7. 仕上げ
- コメント表示（ランダム・重複回避）を反映。
- UI/UX 微調整、バグ修正。

運用ルール:
- 以降の実装は、この順番に沿って進める。
- 順番変更が必要な場合は、このファイルを更新してから進める。

進行状況:
- 2026-02-07: 手順1 着手。
- 2026-02-07: Main.java を UTF-8 へ統一（復元変換適用）。
- 2026-02-07: main_spec.txt に「コメント選定ロジック」「プレッシャー判定」「AI学習感判定」を追記。
- 2026-02-07: 手順1 完了。
- 2026-02-07: Main.java の文言を全面整形（コメント/表示文/プロンプトを読みやすい日本語に置換）。
- 2026-02-07: 手順2 実施。controller/service/domain/viewmodel パッケージを作成し、GET / -> index.html の最小ルーティングを追加。
- 2026-02-07: templates/index.html を追加（最小構成）。
- 2026-02-07: 手順3 実施。入力/出力非依存の GameEngine と GameState を追加し、主要ロジック（判定/AI/スコア/サドンデス）を分離。
- 2026-02-07: 手順4 実施。画面用 DTO/VM と /play API の入出力を定義し、初期状態を index に渡す。
- 2026-02-07: 手順5 実施。index.html にゴール/操作/履歴を配置し、app.css/app.js を追加して API 連携を実装。
- 2026-02-07: 手順6 実施。/reset を追加し、UI に新規試合ボタンを実装。GameService をリセット可能にして動作確認導線を整備。
- 2026-02-07: 手順7 実施。コメント表示（ランダム・重複回避）を API 応答に反映し、画面に表示。
- 2026-02-07: 追加要望対応。キーボード入力対応と簡易アニメーションを実装（app.js/app.css）。
